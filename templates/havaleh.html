{% load static %}
<!DOCTYPE html>
<html dir="rtl" lang="fa">

<head>
    <meta charset="UTF-8">
    <title>حواله خروج از انبار</title>
    <style>
        @font-face {
            font-family: 'BDavat';
            src: url('{% static "fonts/BDavat.ttf" %}') format('truetype');
            font-weight: normal;
            font-style: normal;
        }

        @page {
            size: A4;
            margin: 0;
        }

        body {
            font-family: 'BDavat', Arial, sans-serif;
            margin: 0;
            padding: 0;
            background: white;
            direction: rtl;
        }

        /* Center the whole havaleh block and set a fixed width */
        .havaleh-copy {
            width: 90%;
            max-width: 680px;
            margin: 8px auto;
            border: 1px solid #222;
            background: #fff;
            padding: 8px 10px 50px 10px;
            box-sizing: border-box;
            position: relative;
            min-height: 180px;
            page-break-inside: avoid;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 3px;
        }

        .logo-section {
            width: 55px;
            text-align: right;
        }

        .logo-section img {
            width: 40px;
            height: 40px;
            object-fit: contain;
            display: block;
            margin-bottom: 1px;
        }

        .logo-section div {
            font-size: 7pt;
            text-align: center;
        }

        .company-info {
            flex: 1;
            text-align: center;
            margin: 0 5px;
        }

        .company-name {
            font-size: 11pt;
            font-weight: bold;
            margin-bottom: 1px;
        }

        .document-title {
            font-size: 9pt;
            margin-bottom: 0;
        }

        .document-info {
            width: 100px;
            text-align: left;
            font-size: 7pt;
            line-height: 1.3;
        }

        /* Center the table and set width just like the sample */
        .table-container {
            width: 100%;
            display: flex;
            justify-content: center;
            margin: 4px 0;
            padding-right: 8px;
            box-sizing: border-box;
        }

        table {
            width: 96%;
            margin: 0 auto;
            border-collapse: collapse;
            font-size: 8pt;
            table-layout: fixed;
        }

        th,
        td {
            border: 1px solid #222;
            padding: 2px 2px;
            text-align: center;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            font-family: 'BDavat', Arial, sans-serif;
            height: 16px;
        }

        th {
            background-color: #f7f7f7;
            font-weight: bold;
            height: 18px;
        }

        .col-1 {
            width: 7%;
        }

        .col-2 {
            width: 24%;
        }

        .col-3 {
            width: 10%;
        }

        .col-4 {
            width: 13%;
        }

        .col-5 {
            width: 20%;
        }

        .col-6 {
            width: 13%;
        }

        .col-7 {
            width: 13%;
        }

        .total-row td {
            font-weight: bold;
            background-color: transparent;
            border-top: 1px solid #222;
            height: 18px;
        }

        .notes {
            text-align: right;
            margin: 3px 10px 0 0;
            font-size: 7pt;
            line-height: 1.3;
        }

        .footer {
            display: flex;
            justify-content: space-between;
            gap: 4px;
            position: absolute;
            bottom: 20px;
            left: 10px;
            right: 10px;
        }

        .signature-line {
            flex: 1;
            text-align: center;
            border-top: 1px solid #222;
            padding-top: 2px;
            font-size: 7pt;
        }

        .confirmation-text {
            text-align: right;
            font-size: 7pt;
            position: absolute;
            bottom: 5px;
            right: 10px;
        }
    </style>
</head>

<body>
    {% for i in '123'|make_list %}
    <div class="havaleh-copy">
        <div class="header">
            <div class="logo-section">
                <img src="{% static 'backend/static/images/Homayoun_logo.png' %}" alt="Homayoun Logo">
                <div>همایون</div>
                <div>HOMAYOUN</div>
            </div>
            <div class="company-info">
                <div class="company-name">شرکت صنایع تولیدی کاغذ و مقوای همایون</div>
                <div class="document-title">حواله خروج از انبار</div>
            </div>
            <div class="document-info">
                <div>تاریخ ارسال: {{ persian_date }}</div>
                <div>شماره سریال: {{ serial }}</div>
            </div>
        </div>
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th class="col-1">ردیف</th>
                        <th class="col-2">نام کالا و مشخصات کالا</th>
                        <th class="col-3">گرماژ</th>
                        <th class="col-4">عرض کاغذ</th>
                        <th class="col-5">نام خریدار</th>
                        <th class="col-6">تعداد / مقدار</th>
                        <th class="col-7">وزن کالا</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in items %}
                    <tr>
                        <td>{{ forloop.counter }}</td>
                        <td>{{ item.name }}</td>
                        <td>{{ item.gsm }}</td>
                        <td>{{ item.width }}</td>
                        <td>{{ item.buyer }}</td>
                        <td>{{ item.quantity }}</td>
                        <td>{{ item.weight_persian }}</td>
                    </tr>
                    {% endfor %}
                    <tr class="total-row">
                        <td colspan="6" style="text-align: center;">جمع</td>
                        <td>{{ total_weight_persian }}</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="notes">
            <div>ملاحظات: {{ note }}</div>
        </div>
        <div class="footer">
            <div class="signature-line">حسابداری</div>
            <div class="signature-line">انبارداری</div>
            <div class="signature-line">مدیر فروش</div>
            <div class="signature-line">مدیریت کارخانه</div>
            <div class="signature-line">تحویل گیرنده</div>
        </div>
        <div class="confirmation-text">
            بار صحیح و سالم تحویل اینجانب گردید.
        </div>
    </div>
    {% endfor %}
</body>

</html>