{% load static %}
<!DOCTYPE html>
<html dir="rtl" lang="fa">

<head>
    <meta charset="UTF-8">
    <title>صورت حساب فروش کالا</title>
    <style>
        @font-face {
            font-family: 'BDavat';
            src: url('{% static "fonts/BDavat.ttf" %}') format('truetype');
            font-weight: normal;
            font-style: normal;
        }

        body {
            font-family: 'BDavat', Arial, sans-serif;
            direction: rtl;
            background: white;
            margin: 0;
            padding: 0;
            font-size: 12pt;
        }

        .invoice {
            width: 210mm;
            margin: 5mm auto;
            border: 1.5px solid #000;
            padding: 8mm 5mm;
            box-sizing: border-box;
            page-break-inside: avoid;
            background-color: white;
        }

        .title {
            text-align: center;
            font-size: 18pt;
            font-weight: bold;
            margin-bottom: 8mm;
            padding-bottom: 2mm;
            position: relative;
        }

        .title:after {
            content: "";
            position: absolute;
            bottom: 0;
            right: 20%;
            left: 20%;
            height: 1px;
            background-color: #888;
        }

        .header-section {
            display: flex;
            border: 1.5px solid #000;
            margin-bottom: 5mm;
        }

        .header-title {
            background-color: #d0d0d0;
            padding: 3mm 5mm;
            font-weight: bold;
            text-align: center;
            border-bottom: 1.5px solid #000;
            font-size: 14pt;
        }

        .seller-info,
        .buyer-info {
            width: 100%;
        }

        .info-row {
            display: flex;
        }

        .info-col {
            padding: 2mm 3mm;
            border-left: 1px solid #000;
            flex: 1;
        }

        .info-col:last-child {
            border-left: none;
        }

        .info-label {
            font-weight: normal;
            display: inline-block;
            width: 85px;
            text-align: left;
            color: #333;
        }

        .info-value {
            font-weight: bold;
        }

        .items-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 5mm;
            text-align: center;
        }

        .items-table th {
            background-color: #d0d0d0;
            font-weight: bold;
            border: 1.5px solid #000;
            padding: 2.5mm 2mm;
            font-size: 11pt;
            vertical-align: middle;
        }

        .items-table td {
            border: 1.5px solid #000;
            padding: 3mm 2mm;
            font-size: 12pt;
            vertical-align: middle;
        }

        .col-number {
            width: 5%;
        }

        .col-code {
            width: 6%;
        }

        .col-desc {
            width: 25%;
        }

        .col-qty {
            width: 7%;
        }

        .col-unit {
            width: 6%;
        }

        .col-price {
            width: 10%;
        }

        .col-total {
            width: 12%;
        }

        .col-discount {
            width: 7%;
        }

        .col-tax {
            width: 10%;
        }

        .col-final {
            width: 12%;
        }

        .totals-row td {
            border-top: 2.5px solid #000 !important;
            font-weight: bold;
            padding: 3mm 2mm;
        }

        .amount-in-words {
            border-top: 1.5px solid #000;
            padding: 3mm 2mm;
            font-weight: bold;
            margin-bottom: 15mm;
            font-size: 13pt;
        }

        .footer {
            display: flex;
            justify-content: space-between;
            margin-top: 15mm;
        }

        .signature {
            text-align: center;
            flex: 1;
            padding: 0 10mm;
        }

        .signature-title {
            margin-bottom: 25mm;
            font-weight: bold;
            font-size: 14pt;
        }

        .number-cell {
            direction: ltr;
            text-align: center;
        }

        /* Ensure numbers show as Persian/Arabic numerals */
        .persian-number {
            direction: rtl;
            unicode-bidi: embed;
        }
    </style>
</head>

<body>
    <div class="invoice">
        <div class="title">صورت حساب فروش کالا</div>

        <!-- Seller Information -->
        <div class="header-section">
            <div class="seller-info">
                <div class="header-title">مشخصات فروشنده</div>
                <div class="info-row">
                    <div class="info-col">
                        <span class="info-label">نام شخص حقیقی/حقوقی:</span>
                        <span class="info-value">شرکت صنایع تولیدی کاغذ و مقوای همایون</span>
                    </div>
                    <div class="info-col">
                        <span class="info-label">کد اقتصادی:</span>
                        <span class="info-value persian-number">{{ seller_economic_code|default:"14012603703" }}</span>
                    </div>
                </div>

                <div class="info-row">
                    <div class="info-col">
                        <span class="info-label">شناسه ملی:</span>
                        <span class="info-value persian-number">{{ seller_reg_number|default:"14012603703" }}</span>
                    </div>
                    <div class="info-col">
                        <span class="info-label">کد پستی:</span>
                        <span class="info-value persian-number">{{ seller_postal_code|default:"3364146586" }}</span>
                    </div>
                </div>

                <div class="info-row">
                    <div class="info-col" style="border-bottom: none;">
                        <span class="info-label">شماره:</span>
                        <span class="info-value persian-number">{{ invoice_number|default:"14040056" }}</span>
                    </div>
                    <div class="info-col" style="border-bottom: none;">
                        <span class="info-label">تلفن/نمابر:</span>
                        <span class="info-value persian-number">{{ seller_phone|default:"026-44383368" }}</span>
                    </div>
                </div>

                <div class="info-row">
                    <div class="info-col" style="border-top: none; border-bottom: none;" colspan="2">
                        <span class="info-label">نشانی:</span>
                        <span class="info-value">{{ seller_address|default:"کیلو متر 15 جاده قدیم کرج - قزوین خیابان
                            مرغک خیابان صنعت دومین کارخانه سمت چپ" }}</span>
                    </div>
                </div>

                <div class="info-row">
                    <div class="info-col" style="border-top: none;">
                        <span class="info-label">تاریخ:</span>
                        <span class="info-value persian-number">{{ date|default:"1404/02/15" }}</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Buyer Information -->
        <div class="header-section">
            <div class="buyer-info">
                <div class="header-title">مشخصات خریدار</div>
                <div class="info-row">
                    <div class="info-col">
                        <span class="info-label">نام شخص حقیقی/حقوقی:</span>
                        <span class="info-value">{{ customer_name|default:"شرکت صنایع بسته بندی سهیل البرز ایرانیان"
                            }}</span>
                    </div>
                    <div class="info-col">
                        <span class="info-label">کد اقتصادی:</span>
                        <span class="info-value persian-number">{{ customer_economic_code|default:"14007172415"
                            }}</span>
                    </div>
                </div>

                <div class="info-row">
                    <div class="info-col">
                        <span class="info-label">شناسه ملی:</span>
                        <span class="info-value persian-number">{{ customer_national_id|default:"14007172415" }}</span>
                    </div>
                    <div class="info-col">
                        <span class="info-label">کد پستی:</span>
                        <span class="info-value persian-number">{{ customer_postal_code|default:"3451168795" }}</span>
                    </div>
                </div>

                <div class="info-row">
                    <div class="info-col" style="border-bottom: none;">
                        <span class="info-label">شناسه ثبت:</span>
                        <span class="info-value persian-number">{{ customer_reg_number|default:"14007172415" }}</span>
                    </div>
                    <div class="info-col" style="border-bottom: none;">
                        <span class="info-label">تلفن/نمابر:</span>
                        <span class="info-value persian-number">{{ customer_phone|default:"" }}</span>
                    </div>
                </div>

                <div class="info-row">
                    <div class="info-col" style="border-top: none;" colspan="2">
                        <span class="info-label">نشانی:</span>
                        <span class="info-value">{{ customer_address|default:"قزوین بوئین زهرا-خیابان امام آب گرم کوچه
                            سروناز" }}</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Items Table -->
        <table class="items-table">
            <thead>
                <tr>
                    <th class="col-number">ردیف</th>
                    <th class="col-code">کد کالا</th>
                    <th class="col-desc">شرح کالا یا خدمت</th>
                    <th class="col-qty">مقدار</th>
                    <th class="col-unit">واحد</th>
                    <th class="col-price">قیمت واحد</th>
                    <th class="col-total">مبلغ کل</th>
                    <th class="col-discount">مبلغ تخفیف</th>
                    <th class="col-tax">جمع مالیات و عوارض 10%</th>
                    <th class="col-final">جمع مبلغ کل و مالیات و عوارض</th>
                </tr>
            </thead>
            <tbody>
                {% for item in items %}
                <tr>
                    <td>{{ forloop.counter }}</td>
                    <td class="persian-number">{{ item.code|default:"1005" }}</td>
                    <td>{{ item.description|default:"کاغذ کرافت لاینر کرایه 130 عرض 250" }}</td>
                    <td class="persian-number">{{ item.quantity|default:"23340" }}</td>
                    <td>{{ item.unit|default:"کیلو" }}</td>
                    <td class="persian-number">{{ item.price|default:"370,000" }}</td>
                    <td class="persian-number">{{ item.total|default:"8,635,800,000" }}</td>
                    <td class="persian-number">{{ item.discount|default:"0" }}</td>
                    <td class="persian-number">{{ item.tax|default:"863,580,000" }}</td>
                    <td class="persian-number">{{ item.final_total|default:"9,499,380,000" }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td>۱</td>
                    <td>۱۰۰۵</td>
                    <td>کاغذ کرافت لاینر کرایه 130 عرض 250</td>
                    <td>۲۳۳۴۰</td>
                    <td>کیلو</td>
                    <td>۳۷۰,۰۰۰</td>
                    <td>۸,۶۳۵,۸۰۰,۰۰۰</td>
                    <td>۰</td>
                    <td>۸۶۳,۵۸۰,۰۰۰</td>
                    <td>۹,۴۹۹,۳۸۰,۰۰۰</td>
                </tr>
                {% endfor %}
                <tr class="totals-row">
                    <td colspan="6">جمع کل</td>
                    <td class="persian-number">{{ total_amount|default:"8,635,800,000" }}</td>
                    <td class="persian-number">{{ total_discount|default:"0" }}</td>
                    <td class="persian-number">{{ total_tax|default:"863,580,000" }}</td>
                    <td class="persian-number">{{ grand_total|default:"9,499,380,000" }}</td>
                </tr>
            </tbody>
        </table>

        <div class="amount-in-words">
            <span>به حروف:</span>
            <span>{{ amount_in_words|default:"نه میلیارد و چهارصد و نود و نه میلیون و سیصد و هشتاد هزار" }} ریال</span>
        </div>

        <div class="footer">
            <div class="signature">
                <div class="signature-title">مهر و امضاء فروشنده</div>
            </div>
            <div class="signature">
                <div class="signature-title">مهر و امضاء خریدار</div>
            </div>
        </div>
    </div>
</body>

</html>