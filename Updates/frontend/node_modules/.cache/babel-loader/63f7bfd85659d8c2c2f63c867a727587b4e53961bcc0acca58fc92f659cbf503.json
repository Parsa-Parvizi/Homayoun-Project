{"ast":null,"code":"import \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\nimport { initFlowbite } from 'flowbite';\nimport Card from '@/components/Card';\nimport modal from \"@/components/Modal.vue\";\nimport Alert from \"@/components/Alert.vue\";\nimport Lic_numer from \"@/components/lic_numer.vue\";\nimport { jsPDF } from \"jspdf\";\nimport html2canvas from 'html2canvas';\nexport default {\n  name: \"Products\",\n  components: {\n    Lic_numer,\n    Card,\n    modal,\n    Alert\n  },\n  data() {\n    return {\n      forms: {\n        products: {\n          type: 'input',\n          title: 'لیست محصولات',\n          filter: 'یک سال اخیر',\n          data: '',\n          value: '',\n          fields: []\n        }\n      },\n      filters: [{\n        lable: 'یک سال اخیر',\n        value: 'year'\n      }, {\n        lable: 'یک ماه اخیر',\n        value: 'month'\n      }, {\n        lable: 'هفته اخیر',\n        value: 'week'\n      }, {\n        lable: 'امروز',\n        value: 'day'\n      }],\n      success: false,\n      error: false,\n      errors: []\n    };\n  },\n  mounted() {\n    initFlowbite();\n    this.report_Products('year');\n  },\n  methods: {\n    async generate_excel_report(model_name) {\n      console.log(model_name);\n      const params = {\n        'model_name': model_name\n      };\n      const response = await this.axios.post('/myapp/api/generateExcelReport', {}, {\n        params: params,\n        responseType: 'blob'\n      });\n      // Create a URL for the blob\n      const url = window.URL.createObjectURL(new Blob([response.data]));\n      const link = document.createElement('a');\n      link.href = url;\n\n      // Suggest a filename for the downloaded file\n      const filename = response.headers['content-disposition'];\n      link.setAttribute('download', filename);\n\n      // Append the link to the body\n      document.body.appendChild(link);\n\n      // Simulate click to download the file\n      link.click();\n\n      // Remove the link from the body\n      document.body.removeChild(link);\n      console.log(response.data);\n    },\n    select(obj) {\n      this.forms.shipment_list.value = obj;\n    },\n    clicked(k, data) {\n      if (k == 'products') {\n        this.forms.products.filter = data.lable;\n        this.report_Products(data.value);\n      }\n    },\n    printTable(id) {\n      let table = document.getElementById(id); // Replace 'yourTableId' with your table's ID\n      console.log(table);\n      html2canvas(table).then(function (canvas) {\n        let imgData = canvas.toDataURL('image/png');\n        console.log(imgData);\n        var doc = new jsPDF('p', 'mm', 'a4');\n        var imgHeight = canvas.height * 210 / canvas.width;\n        doc.addImage(imgData, 'PNG', 0, 0, 210, imgHeight);\n        doc.save('table.pdf');\n      });\n    },\n    async report_Products(filter) {\n      try {\n        const params = {\n          'filter': filter\n        };\n        const response = await this.axios.post('/myapp/ProductsPage/', {}, {\n          params: params\n        });\n        console.log(response.data);\n        this.forms['products'].data = response.data['values'];\n        this.forms['products'].fields = response.data['fields'];\n      } catch (error) {\n        console.error(\"Error fetching products report:\", error);\n        // Optionally, display an error message to the user\n        // this.errorMessage = \"Failed to fetch products report. Please try again.\";\n      }\n    }\n  }\n};","map":{"version":3,"names":["initFlowbite","Card","modal","Alert","Lic_numer","jsPDF","html2canvas","name","components","data","forms","products","type","title","filter","value","fields","filters","lable","success","error","errors","mounted","report_Products","methods","generate_excel_report","model_name","console","log","params","response","axios","post","responseType","url","window","URL","createObjectURL","Blob","link","document","createElement","href","filename","headers","setAttribute","body","appendChild","click","removeChild","select","obj","shipment_list","clicked","k","printTable","id","table","getElementById","then","canvas","imgData","toDataURL","doc","imgHeight","height","width","addImage","save"],"sources":["C:\\Users\\Amir\\ISMv988\\ISMv900\\frontend\\src\\components\\admin\\Products.vue"],"sourcesContent":["<script>\r\nimport { initFlowbite } from 'flowbite'\r\nimport Card from '@/components/Card'\r\nimport modal from \"@/components/Modal.vue\";\r\nimport Alert from \"@/components/Alert.vue\";\r\nimport Lic_numer from \"@/components/lic_numer.vue\";\r\nimport { jsPDF } from \"jspdf\";\r\nimport html2canvas from 'html2canvas';\r\n\r\nexport default {\r\n  name: \"Products\",\r\n  components: {\r\n    Lic_numer,\r\n    Card,\r\n    modal,\r\n    Alert\r\n  },\r\n  data(){\r\n    return {\r\n      forms: {\r\n        products:{type:'input', title: 'لیست محصولات',filter:'یک سال اخیر', data:'', value:'', fields: []},\r\n      },\r\n      filters: [\r\n        {lable:'یک سال اخیر', value: 'year'},\r\n        {lable:'یک ماه اخیر', value: 'month'},\r\n        {lable:'هفته اخیر', value: 'week'},\r\n        {lable:'امروز', value: 'day'},\r\n      ],\r\n      success: false,\r\n      error: false,\r\n      errors: [],\r\n    }\r\n  },\r\n  mounted() {\r\n    initFlowbite();\r\n    this.report_Products('year')\r\n  },\r\n  methods: {\r\n    async generate_excel_report(model_name){\r\n      console.log(model_name)\r\n      const params = {\r\n        'model_name':model_name,\r\n      }\r\n      const response = await this.axios.post('/myapp/api/generateExcelReport',{}, {params:params,responseType: 'blob',},)\r\n      // Create a URL for the blob\r\n      const url = window.URL.createObjectURL(new Blob([response.data]));\r\n      const link = document.createElement('a');\r\n      link.href = url;\r\n\r\n      // Suggest a filename for the downloaded file\r\n      const filename = response.headers['content-disposition'];\r\n      link.setAttribute('download', filename);\r\n\r\n      // Append the link to the body\r\n      document.body.appendChild(link);\r\n\r\n      // Simulate click to download the file\r\n      link.click();\r\n\r\n      // Remove the link from the body\r\n      document.body.removeChild(link);\r\n\r\n      console.log(response.data)\r\n    },\r\n    select(obj){\r\n      this.forms.shipment_list.value = obj\r\n    },\r\n    clicked(k, data){\r\n      if (k == 'products'){\r\n        this.forms.products.filter = data.lable\r\n        this.report_Products(data.value)\r\n      }\r\n    },\r\n    printTable(id) {\r\n        let table = document.getElementById(id); // Replace 'yourTableId' with your table's ID\r\n        console.log(table)\r\n        html2canvas(table).then(function(canvas) {\r\n            let imgData = canvas.toDataURL('image/png');\r\n            console.log(imgData)\r\n            var doc = new jsPDF('p', 'mm', 'a4');\r\n            var imgHeight = canvas.height * 210 / canvas.width;\r\n            doc.addImage(imgData, 'PNG', 0, 0, 210, imgHeight);\r\n            doc.save('table.pdf');\r\n        });\r\n    },\r\n\r\n    async report_Products(filter) {\r\n     try {\r\n        const params = {\r\n          'filter': filter,\r\n        }\r\n        const response = await this.axios.post('/myapp/ProductsPage/', {}, {params:params})\r\n        console.log(response.data);\r\n        this.forms['products'].data = response.data['values']\r\n        this.forms['products'].fields = response.data['fields']\r\n     } catch (error) {\r\n        console.error(\"Error fetching products report:\", error);\r\n        // Optionally, display an error message to the user\r\n        // this.errorMessage = \"Failed to fetch products report. Please try again.\";\r\n     }\r\n    },\r\n\r\n\r\n  },\r\n}\r\n</script>\r\n\r\n<template>\r\n\r\n\r\n<!--<Card title=\"گزارش\">-->\r\n  <div class=\"w-screen p-5 container\">\r\n<!--  <p class=\"flex flex-row gap-2 items-center\">-->\r\n<!--    <button @click=\"reload\" class=\"w-auto block text-white bg-green-500 hover:bg-green-600 focus:ring-4 focus:outline-none focus:ring-green-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800\" type=\"button\">-->\r\n<!--      بارگیری مجدد-->\r\n<!--    </button>-->\r\n<!--    {{ formattedTime }}-->\r\n<!--  </p>-->\r\n  <form class=\"flex flex-col items-center mt-5 gap-4\">\r\n    <template v-for=\"(val, form_name) in forms\">\r\n        <div class=\"relative w-full h-auto max-h-[500px] overflow-y-scroll overflow-x-auto shadow-md sm:rounded-lg\">\r\n            <table :id=\"form_name\" class=\"w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400\">\r\n                <caption class=\"p-5 text-lg font-semibold text-left rtl:text-right text-gray-900 bg-white dark:text-white dark:bg-gray-800\">\r\n\r\n                    <div class=\"flex flex-row gap-2 items-center\">\r\n                      {{val.title}}\r\n<!--                      <button @click=\"printTable(form_name)\" class=\"w-auto block text-white bg-green-500 hover:bg-green-600 focus:ring-4 focus:outline-none focus:ring-green-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800\" type=\"button\">-->\r\n<!--                        PDF-->\r\n<!--                      </button>-->\r\n<!--                      <button @click=\"generate_excel_report(form_name)\"  class=\"w-auto block text-white bg-green-500 hover:bg-green-600 focus:ring-4 focus:outline-none focus:ring-green-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800\" type=\"button\">-->\r\n<!--                      XLS-->\r\n<!--                    </button>-->\r\n                      <button :id=\"form_name + 'Button1'\" :data-dropdown-toggle=\"form_name+'dropdown1'\" class=\"justify-between w-44 text-white bg-green-500 hover:bg-green-600 focus:ring-4 focus:outline-none focus:ring-green-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800\" type=\"button\">\r\n                        {{ val.filter }}\r\n                        <svg class=\"w-2.5 h-2.5 ms-3\" aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 10 6\">\r\n                          <path stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"m1 1 4 4 4-4\"/>\r\n                        </svg>\r\n                      </button>\r\n                      <!-- Dropdown menu -->\r\n                      <div :id=\"form_name+'dropdown1'\" class=\"z-50 hidden bg-white divide-y divide-gray-100 rounded-lg shadow w-44 dark:bg-gray-700\">\r\n                        <ul class=\"overflow-y-auto h-auto max-h-48 py-2 text-sm text-gray-700 dark:text-gray-200\" :aria-labelledby=\"form_name + 'Button1'\">\r\n                          <li v-for=\"data in filters\">\r\n                            <a @click='clicked(form_name ,data)' type=\"button\" class=\"block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white\">\r\n                              {{ data.lable }}\r\n                            </a>\r\n                          </li>\r\n                        </ul>\r\n                      </div>\r\n\r\n                    </div>\r\n\r\n                </caption>\r\n                <thead class=\"text-xs text-gray-100 uppercase bg-green-500 dark:bg-gray-700 dark:text-gray-400\">\r\n                    <tr>\r\n                         <template v-for=\"(i ,k) in val.fields\">\r\n                           <template v-if=\"i !='id'\">\r\n                              <th scope=\"col\" class=\"px-2 py-3\">\r\n                                  {{i}}\r\n                              </th>\r\n                           </template>\r\n                      </template>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    <template v-for=\"(v, index) in val.data\">\r\n                          <tr class=\"truncate bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-green-50 dark:hover:bg-gray-600\">\r\n                            <template v-for=\"(field ,k) in val.fields\">\r\n                              <template v-if=\"field !='id'\">\r\n                                <td class=\"w-4 p-4\">\r\n                                  {{ v[field] }}\r\n                                </td>\r\n                              </template>\r\n                            </template>\r\n                          </tr>\r\n                    </template>\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n    </template>\r\n  </form>\r\n  </div>\r\n<!--</Card>-->\r\n</template>\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}