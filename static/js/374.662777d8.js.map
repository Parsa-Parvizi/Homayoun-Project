{"version":3,"file":"js/374.662777d8.js","mappings":"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","sources":["webpack://frontend/./src/components/Havaleh.vue","webpack://frontend/./src/components/Havaleh.vue?10e4"],"sourcesContent":["<template>\n  <div class=\"havaleh-form\">\n    <h2>حواله خروج از انبار</h2>\n    <div class=\"loading-state\" v-if=\"loading\">\n      <p>در حال بارگیری اطلاعات فاکتور...</p>\n    </div>\n    <div class=\"no-invoice\" v-else-if=\"!hasInvoice\">\n      <p>فاکتوری با وضعیت تایید نشده وجود ندارد.</p>\n    </div>\n    <div v-else>\n      <div class=\"form-header\">\n        <div class=\"form-group\">\n          <label>تاریخ ارسال:</label>\n          <input type=\"text\" v-model=\"formData.date\" readonly />\n        </div>\n        <div class=\"form-group\">\n          <label>شماره سریال:</label>\n          <input type=\"text\" v-model=\"formData.serial\" />\n        </div>\n        <div class=\"form-group\">\n          <label>شماره فاکتور:</label>\n          <input type=\"text\" v-model=\"pendingInvoice.invoice_number\" readonly />\n        </div>\n        <div class=\"form-group\">\n          <label>مشتری:</label>\n          <input type=\"text\" v-model=\"pendingInvoice.customer_name\" readonly />\n        </div>\n      </div>\n\n      <!-- Items Table -->\n      <div class=\"items-table\">\n        <table>\n          <thead>\n            <tr>\n              <th>ردیف</th>\n              <th>نام کالا و مشخصات کالا</th>\n              <th>گرماژ</th>\n              <th>عرض کاغذ</th>\n              <th>نام خریدار</th>\n              <th>تعداد / مقدار</th>\n              <th>وزن کالا</th>\n              <th>عملیات</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr v-for=\"(item, index) in formData.items\" :key=\"index\">\n              <td>{{ index + 1 }}</td>\n              <td>\n                <input type=\"text\" v-model=\"item.name\" />\n              </td>\n              <td>\n                <input type=\"text\" v-model=\"item.gsm\" />\n              </td>\n              <td>\n                <input type=\"text\" v-model=\"item.width\" />\n              </td>\n              <td>\n                <input type=\"text\" v-model=\"item.buyer\" />\n              </td>\n              <td>\n                <input type=\"number\" v-model=\"item.quantity\" />\n              </td>\n              <td>\n                <input type=\"number\" v-model=\"item.weight\" />\n              </td>\n              <td>\n                <button @click=\"removeItem(index)\" class=\"remove-btn\">حذف</button>\n              </td>\n            </tr>\n          </tbody>\n        </table>\n        <button @click=\"addItem\" class=\"add-btn\">افزودن ردیف جدید</button>\n      </div>\n\n      <div class=\"form-footer\">\n        <div class=\"form-group\">\n          <label>ملاحظات:</label>\n          <textarea v-model=\"formData.note\"></textarea>\n        </div>\n        <div class=\"total-weight\">\n          <strong>جمع کل وزن:</strong> {{ calculateTotalWeight() }}\n        </div>\n        <div class=\"button-group\">\n          <button @click=\"confirmInvoiceAndGeneratePDF\" class=\"confirm-btn\">تایید فاکتور و تولید PDF</button>\n          <button @click=\"generatePDF\" class=\"generate-btn\">تولید PDF بدون تایید</button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'Havaleh',\n  data() {\n    return {\n      loading: true,\n      hasInvoice: false,\n      pendingInvoice: null,\n      formData: {\n        date: this.getCurrentDate(),\n        serial: '',\n        items: [],\n        note: ''\n      }\n    }\n  },\n  created() {\n    // Fetch the latest pending invoice when component is created\n    this.fetchLatestPendingInvoice();\n  },\n  methods: {\n    async fetchLatestPendingInvoice() {\n      try {\n        this.loading = true;\n        // Use absolute URLs with window.location.origin\n        const base = window.location.origin;\n        const response = await fetch(`${base}/myapp/api/latest-pending-sale/`);\n        \n        if (!response.ok) {\n          if (response.status === 404) {\n            this.hasInvoice = false;\n            this.loading = false;\n            return;\n          }\n          throw new Error(`Error ${response.status}: ${await response.text()}`);\n        }\n        \n        const data = await response.json();\n        this.pendingInvoice = data;\n        this.hasInvoice = true;\n        \n        // Populate form data from invoice\n        this.formData.serial = `HV-${data.id}`;\n        \n        // Create items from reels if available\n        if (data.list_of_reels) {\n          const reels = data.list_of_reels.split(',');\n          \n          reels.forEach(reel => {\n            this.formData.items.push({\n              name: `رول ${reel.trim()}`,\n              gsm: '',\n              width: data.width || '',\n              buyer: data.customer_name || '',\n              quantity: 1,\n              weight: data.net_weight ? Math.round(data.net_weight / reels.length) : 0\n            });\n          });\n        } else {\n          // Default single item\n          this.addItem();\n          if (this.formData.items.length > 0) {\n            this.formData.items[0].buyer = data.customer_name || '';\n            this.formData.items[0].width = data.width || '';\n            this.formData.items[0].weight = data.net_weight || 0;\n          }\n        }\n      } catch (error) {\n        console.error('Error fetching pending invoice:', error);\n        this.hasInvoice = false;\n      } finally {\n        this.loading = false;\n      }\n    },\n    getCurrentDate() {\n      // Convert to Iranian date format\n      const today = new Date();\n      // Format: YYYY/MM/DD\n      const year = today.getFullYear();\n      const month = String(today.getMonth() + 1).padStart(2, '0');\n      const day = String(today.getDate()).padStart(2, '0');\n      return `${year}/${month}/${day}`;\n    },\n    addItem() {\n      this.formData.items.push({\n        name: '',\n        gsm: '',\n        width: '',\n        buyer: this.pendingInvoice?.customer_name || '',\n        quantity: '',\n        weight: ''\n      });\n    },\n    removeItem(index) {\n      this.formData.items.splice(index, 1);\n    },\n    calculateTotalWeight() {\n      return this.formData.items.reduce((total, item) => {\n        return total + (parseFloat(item.weight) || 0);\n      }, 0).toLocaleString();\n    },\n    async confirmInvoiceAndGeneratePDF() {\n      if (!this.pendingInvoice || !this.pendingInvoice.id) {\n        alert('هیچ فاکتوری برای تایید وجود ندارد.');\n        return;\n      }\n      \n      try {\n        // First confirm the invoice\n        const base = window.location.origin;\n        const confirmResponse = await fetch(`${base}/myapp/api/confirm-sales-invoice/${this.pendingInvoice.id}/`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n            'X-CSRFToken': this.getCookie('csrftoken'),\n          },\n          credentials: 'include'\n        });\n        \n        if (!confirmResponse.ok) {\n          const errorData = await confirmResponse.json();\n          throw new Error(errorData.error || 'خطا در تایید فاکتور');\n        }\n        \n        // Then generate the PDF\n        await this.generatePDF();\n        \n        // Refresh the page to fetch a new pending invoice\n        setTimeout(() => {\n          this.fetchLatestPendingInvoice();\n        }, 1000);\n        \n      } catch (error) {\n        console.error('خطا در تایید فاکتور:', error);\n        alert('خطا در تایید فاکتور: ' + error.message);\n      }\n    },\n    async generatePDF() {\n      try {\n        const requestData = {\n          date: this.formData.date,\n          serial: this.formData.serial,\n          items: this.formData.items,\n          note: this.formData.note,\n          invoice_id: this.pendingInvoice?.id\n        };\n\n        console.log('Form data being sent:', requestData);\n        \n        const base = window.location.origin;\n        const response = await fetch(`${base}/myapp/api/havaleh-pdf/`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n            'X-CSRFToken': this.getCookie('csrftoken'),\n          },\n          body: JSON.stringify(requestData),\n          credentials: 'include'\n        });\n\n        if (!response.ok) {\n          const errorData = await response.json();\n          throw new Error(errorData.error || 'Error generating PDF');\n        }\n\n        const blob = await response.blob();\n        const url = window.URL.createObjectURL(blob);\n        const a = document.createElement('a');\n        a.href = url;\n        a.download = `havaleh_${this.formData.serial}.pdf`;\n        document.body.appendChild(a);\n        a.click();\n        window.URL.revokeObjectURL(url);\n        document.body.removeChild(a);\n\n      } catch (error) {\n        console.error('خطا در تولید PDF:', error);\n        alert('خطا در تولید PDF: ' + error.message);\n      }\n    },\n    getCookie(name) {\n      let cookieValue = null;\n      if (document.cookie && document.cookie !== '') {\n        const cookies = document.cookie.split(';');\n        for (let i = 0; i < cookies.length; i++) {\n          const cookie = cookies[i].trim();\n          if (cookie.substring(0, name.length + 1) === (name + '=')) {\n            cookieValue = decodeURIComponent(cookie.substring(name.length + 1));\n            break;\n          }\n        }\n      }\n      return cookieValue;\n    }\n  }\n}\n</script>\n\n<style scoped>\n.loading-state, .no-invoice {\n  text-align: center;\n  margin: 2rem 0;\n  padding: 1rem;\n  background-color: #f9f9f9;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n}\n\n.button-group {\n  display: flex;\n  gap: 10px;\n  margin-top: 15px;\n}\n\n.confirm-btn {\n  background-color: #4CAF50;\n  color: white;\n  padding: 10px 15px;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n}\n\n.generate-btn {\n  background-color: #2196F3;\n  color: white;\n  padding: 10px 15px;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n}\n\n.add-btn {\n  background-color: #4CAF50;\n  color: white;\n  margin-top: 10px;\n  padding: 5px 10px;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n}\n\n.remove-btn {\n  background-color: #f44336;\n  color: white;\n  padding: 5px 10px;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n}\n\n/* Form styling */\n.form-header {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 15px;\n  margin-bottom: 20px;\n}\n\n.form-group {\n  margin-bottom: 15px;\n}\n\n.form-group label {\n  display: block;\n  margin-bottom: 5px;\n  font-weight: bold;\n}\n\n.form-group input, .form-group textarea {\n  width: 100%;\n  padding: 8px;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n}\n\n/* Table styling */\n.items-table {\n  margin-bottom: 20px;\n}\n\ntable {\n  width: 100%;\n  border-collapse: collapse;\n}\n\nth, td {\n  border: 1px solid #ddd;\n  padding: 8px;\n  text-align: right;\n}\n\nth {\n  background-color: #f2f2f2;\n  font-weight: bold;\n}\n\n.total-weight {\n  margin-top: 15px;\n  font-weight: bold;\n}\n</style>","import { render } from \"./Havaleh.vue?vue&type=template&id=78bf9458&scoped=true\"\nimport script from \"./Havaleh.vue?vue&type=script&lang=js\"\nexport * from \"./Havaleh.vue?vue&type=script&lang=js\"\n\nimport \"./Havaleh.vue?vue&type=style&index=0&id=78bf9458&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-78bf9458\"]])\n\nexport default __exports__"],"names":["class","_createElementVNode","key","_hoisted_4","_hoisted_7","_createElementBlock","_hoisted_1","_hoisted_2","$data","loading","_hoisted_3","_hoisted_5","hasInvoice","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","type","_cache","$event","formData","date","readonly","_hoisted_13","_hoisted_14","serial","_hoisted_15","_hoisted_16","pendingInvoice","invoice_number","_hoisted_17","_hoisted_18","customer_name","_hoisted_19","_hoisted_20","_Fragment","_renderList","items","item","index","_toDisplayString","name","_hoisted_21","gsm","_hoisted_22","width","_hoisted_23","buyer","_hoisted_24","quantity","_hoisted_25","weight","_hoisted_26","onClick","$options","removeItem","_hoisted_27","args","addItem","_hoisted_28","_hoisted_29","_hoisted_30","note","_hoisted_31","_hoisted_32","_createTextVNode","calculateTotalWeight","_hoisted_33","confirmInvoiceAndGeneratePDF","generatePDF","_hoisted_6","_hoisted_8","data","this","getCurrentDate","created","fetchLatestPendingInvoice","methods","base","window","location","origin","response","fetch","ok","status","Error","text","json","id","list_of_reels","reels","split","forEach","reel","push","trim","net_weight","Math","round","length","error","console","today","Date","year","getFullYear","month","String","getMonth","padStart","day","getDate","splice","reduce","total","parseFloat","toLocaleString","confirmResponse","method","headers","getCookie","credentials","errorData","setTimeout","alert","message","requestData","invoice_id","log","body","JSON","stringify","blob","url","URL","createObjectURL","a","document","createElement","href","download","appendChild","click","revokeObjectURL","removeChild","cookieValue","cookie","cookies","i","substring","decodeURIComponent","__exports__","render"],"sourceRoot":""}